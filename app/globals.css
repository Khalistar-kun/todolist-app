/* Import Inter font - must be at top before @tailwind directives */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================================================
   LIGHT MODE DESIGN TOKENS
   ============================================================================ */
:root {
  /* Background colors - calm, eye-friendly */
  --bg-app: #f6f7f9;
  --bg-card: #ffffff;
  --bg-card-hover: #fafbfc;
  --bg-elevated: #ffffff;
  --bg-input: #ffffff;
  --bg-sidebar: #ffffff;

  /* Border colors */
  --border-subtle: #e5e7eb;
  --border-default: #d1d5db;
  --border-strong: #9ca3af;

  /* Text colors - improved contrast for readability */
  --text-primary: #111827;
  --text-secondary: #374151;
  --text-muted: #4b5563;
  --text-placeholder: #6b7280;

  /* Icon colors - improved visibility */
  --icon-default: #4b5563;
  --icon-hover: #111827;
  --icon-muted: #6b7280;

  /* Shadows - subtle elevation */
  --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-card-hover: 0 4px 6px rgba(0, 0, 0, 0.05), 0 2px 4px rgba(0, 0, 0, 0.06);
  --shadow-elevated: 0 4px 6px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);
  --shadow-dropdown: 0 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -2px rgba(0, 0, 0, 0.04);

  /* Priority badge colors - better contrast */
  --priority-low-bg: #dcfce7;
  --priority-low-text: #166534;
  --priority-medium-bg: #fef3c7;
  --priority-medium-text: #92400e;
  --priority-high-bg: #fee2e2;
  --priority-high-text: #991b1b;
  --priority-urgent-bg: #fecaca;
  --priority-urgent-text: #7f1d1d;
  --priority-none-bg: #e5e7eb;
  --priority-none-text: #374151;

  /* Status colors - better contrast */
  --status-todo-bg: #e5e7eb;
  --status-todo-text: #374151;
  --status-progress-bg: #dbeafe;
  --status-progress-text: #1e40af;
  --status-done-bg: #dcfce7;
  --status-done-text: #166534;

  /* Accent/interactive colors */
  --accent-primary: #2563eb;
  --accent-primary-hover: #1d4ed8;
  --accent-success: #16a34a;
  --accent-warning: #d97706;
  --accent-danger: #dc2626;
}

/* Dark mode overrides */
.dark {
  --bg-app: #111827;
  --bg-card: #1f2937;
  --bg-card-hover: #374151;
  --bg-elevated: #1f2937;
  --bg-input: #374151;
  --bg-sidebar: #1f2937;

  --border-subtle: #374151;
  --border-default: #4b5563;
  --border-strong: #6b7280;

  --text-primary: #f9fafb;
  --text-secondary: #d1d5db;
  --text-muted: #9ca3af;
  --text-placeholder: #6b7280;

  --icon-default: #9ca3af;
  --icon-hover: #f9fafb;
  --icon-muted: #6b7280;

  --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2);
  --shadow-card-hover: 0 4px 6px rgba(0, 0, 0, 0.35), 0 2px 4px rgba(0, 0, 0, 0.25);
  --shadow-elevated: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
  --shadow-dropdown: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3);

  --priority-low-bg: rgba(34, 197, 94, 0.2);
  --priority-low-text: #86efac;
  --priority-medium-bg: rgba(234, 179, 8, 0.2);
  --priority-medium-text: #fde047;
  --priority-high-bg: rgba(239, 68, 68, 0.2);
  --priority-high-text: #fca5a5;
  --priority-urgent-bg: rgba(220, 38, 38, 0.3);
  --priority-urgent-text: #fecaca;
  --priority-none-bg: #374151;
  --priority-none-text: #9ca3af;

  --status-todo-bg: #374151;
  --status-todo-text: #d1d5db;
  --status-progress-bg: rgba(59, 130, 246, 0.2);
  --status-progress-text: #93c5fd;
  --status-done-bg: rgba(34, 197, 94, 0.2);
  --status-done-text: #86efac;

  --accent-primary: #3b82f6;
  --accent-primary-hover: #60a5fa;
}

/* Base Styles */
@layer base {
  html {
    @apply antialiased scroll-smooth;
    /* Prevent pull-to-refresh in horizontal direction */
    overscroll-behavior-x: none;
  }

  body {
    background-color: var(--bg-app);
    color: var(--text-primary);
    @apply font-sans transition-colors duration-200;
  }

  /* Scrollbar visibility - show on mobile for feedback, hide on desktop until hover */
  * {
    scrollbar-width: thin;
    /* Show scrollbar on mobile */
    scrollbar-color: rgba(155, 155, 155, 0.3) transparent;
  }

  /* Desktop: hide scrollbar until hover */
  @media (min-width: 768px) {
    * {
      scrollbar-color: transparent transparent;
    }
  }

  *::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  *::-webkit-scrollbar-track {
    background: transparent;
  }

  *::-webkit-scrollbar-thumb {
    /* Visible on mobile by default for feedback */
    background: rgba(155, 155, 155, 0.3);
    border-radius: 3px;
  }

  /* Desktop: hide until hover */
  @media (min-width: 768px) {
    *::-webkit-scrollbar-thumb {
      background: transparent;
    }

    *:hover::-webkit-scrollbar-thumb {
      background: rgba(155, 155, 155, 0.3);
    }
  }

  *::-webkit-scrollbar-thumb:hover {
    background: rgba(155, 155, 155, 0.5);
  }
}

/* Component Styles */
@layer components {
  /* Card - with proper elevation */
  .card {
    background-color: var(--bg-card);
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-card);
    @apply rounded-xl transition-shadow duration-200;
  }

  .card:hover {
    box-shadow: var(--shadow-card-hover);
  }

  /* Task card - specific styling */
  .task-card {
    background-color: var(--bg-card);
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-card);
    @apply rounded-lg transition-all duration-200;
  }

  .task-card:hover {
    background-color: var(--bg-card-hover);
    box-shadow: var(--shadow-card-hover);
  }

  /* Elevated components (modals, dropdowns) */
  .elevated {
    background-color: var(--bg-elevated);
    box-shadow: var(--shadow-elevated);
  }

  .dropdown {
    background-color: var(--bg-elevated);
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-dropdown);
  }

  /* Buttons */
  .btn {
    @apply inline-flex items-center justify-center gap-2 font-medium rounded-lg;
    @apply transition-all duration-200;
    @apply focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500;
    @apply dark:focus:ring-offset-gray-900;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .btn-sm {
    @apply px-3 py-1.5 text-sm;
  }

  .btn-md {
    @apply px-4 py-2 text-sm;
  }

  .btn-lg {
    @apply px-5 py-2.5 text-base;
  }

  .btn-primary {
    @apply bg-blue-600 text-white;
    @apply hover:bg-blue-700;
    @apply dark:bg-blue-500 dark:hover:bg-blue-600;
  }

  .btn-secondary {
    @apply bg-gray-100 text-gray-700 border border-gray-300;
    @apply hover:bg-gray-200;
    @apply dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600;
    @apply dark:hover:bg-gray-600;
  }

  .btn-ghost {
    @apply bg-transparent text-gray-600;
    @apply hover:bg-gray-100;
    @apply dark:text-gray-400 dark:hover:bg-gray-800;
  }

  .btn-danger {
    @apply bg-red-600 text-white;
    @apply hover:bg-red-700;
  }

  /* Input - MOBILE FIX: 16px font prevents iOS zoom */
  .input {
    @apply w-full px-3 py-2 text-base bg-white rounded-lg;
    @apply border border-gray-300;
    @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent;
    @apply dark:bg-gray-800 dark:border-gray-600 dark:text-white;
    @apply placeholder:text-gray-400 dark:placeholder:text-gray-500;
  }

  /* Badge */
  .badge {
    @apply inline-flex items-center px-2 py-0.5 rounded text-xs font-medium;
  }

  .badge-gray {
    background-color: var(--priority-none-bg);
    color: var(--priority-none-text);
  }

  .badge-primary {
    background-color: var(--status-progress-bg);
    color: var(--status-progress-text);
  }

  .badge-success {
    background-color: var(--priority-low-bg);
    color: var(--priority-low-text);
  }

  .badge-warning {
    background-color: var(--priority-medium-bg);
    color: var(--priority-medium-text);
  }

  .badge-error {
    background-color: var(--priority-high-bg);
    color: var(--priority-high-text);
  }

  /* Priority badges - muted, calming colors */
  .badge-priority-none {
    background-color: var(--priority-none-bg);
    color: var(--priority-none-text);
  }

  .badge-priority-low {
    background-color: var(--priority-low-bg);
    color: var(--priority-low-text);
  }

  .badge-priority-medium {
    background-color: var(--priority-medium-bg);
    color: var(--priority-medium-text);
  }

  .badge-priority-high {
    background-color: var(--priority-high-bg);
    color: var(--priority-high-text);
  }

  .badge-priority-urgent {
    background-color: var(--priority-urgent-bg);
    color: var(--priority-urgent-text);
  }

  /* Status badges */
  .badge-status-todo {
    background-color: var(--status-todo-bg);
    color: var(--status-todo-text);
  }

  .badge-status-progress {
    background-color: var(--status-progress-bg);
    color: var(--status-progress-text);
  }

  .badge-status-done {
    background-color: var(--status-done-bg);
    color: var(--status-done-text);
  }

  /* Stat card */
  .stat-card {
    @apply card p-5;
  }

  .stat-value {
    color: var(--text-primary);
    @apply text-2xl font-bold;
  }

  .stat-label {
    color: var(--text-muted);
    @apply text-sm;
  }

  /* Page header */
  .page-header {
    @apply mb-6;
  }

  .page-title {
    color: var(--text-primary);
    @apply text-2xl font-bold;
  }

  .page-description {
    color: var(--text-secondary);
    @apply mt-1;
  }

  .section-title {
    color: var(--text-primary);
    @apply text-base font-semibold;
  }

  /* Text utility classes */
  .text-primary {
    color: var(--text-primary);
  }

  .text-secondary {
    color: var(--text-secondary);
  }

  .text-muted {
    color: var(--text-muted);
  }

  /* Icon utility classes */
  .icon-default {
    color: var(--icon-default);
  }

  .icon-default:hover {
    color: var(--icon-hover);
  }

  .icon-muted {
    color: var(--icon-muted);
  }

  /* Empty state */
  .empty-state {
    @apply flex flex-col items-center justify-center py-12 px-4 text-center;
  }

  .empty-state-icon {
    color: var(--icon-muted);
    @apply w-12 h-12 mb-3;
  }

  .empty-state-title {
    color: var(--text-primary);
    @apply text-sm font-medium mb-1;
  }

  .empty-state-description {
    color: var(--text-muted);
    @apply text-sm;
  }

  /* List item */
  .list-item {
    @apply flex items-center gap-3 px-4 py-3;
    @apply transition-colors cursor-pointer;
  }

  .list-item:hover {
    background-color: var(--bg-card-hover);
  }

  /* Spinner */
  .spinner {
    @apply animate-spin rounded-full border-2;
    @apply border-gray-200 border-t-blue-600;
    @apply dark:border-gray-700 dark:border-t-blue-400;
  }

  .spinner-sm {
    @apply w-4 h-4;
  }

  .spinner-md {
    @apply w-5 h-5;
  }

  .spinner-lg {
    @apply w-8 h-8;
  }

  /* Glass nav */
  .glass {
    @apply bg-white/90 backdrop-blur-sm;
    @apply dark:bg-gray-900/90;
  }
}

/* Utilities */
@layer utilities {
  .press-scale {
    @apply active:scale-[0.98] transition-transform;
  }

  .hover-lift {
    @apply hover:-translate-y-0.5 hover:shadow-md transition-all;
  }

  /* MOBILE TOUCH UTILITIES */
  /* Minimum 44x44px touch target for WCAG compliance */
  .touch-target {
    @apply min-w-[44px] min-h-[44px] flex items-center justify-center;
  }

  /* Prevent text selection on touch drag */
  .touch-none {
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
  }

  /* Smooth momentum scrolling for mobile */
  .touch-scroll {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  /* Prevent tap highlight on mobile */
  .tap-highlight-none {
    -webkit-tap-highlight-color: transparent;
  }
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

.animate-fade-in {
  animation: fadeIn 0.2s ease-out;
}

.animate-slide-up {
  animation: slideUp 0.2s ease-out;
}

.animate-scale-in {
  animation: scaleIn 0.15s ease-out;
}

/* Slide down animation for notifications */
@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slide-down {
  animation: slideDown 0.3s ease-out forwards;
}

/* Toast enter/leave animations */
.animate-enter {
  animation: slideDown 0.3s ease-out forwards;
}

.animate-leave {
  animation: slideDown 0.3s ease-in reverse forwards;
}

/* MOBILE: Reduce motion for accessibility */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Date/time input styling - light mode by default */
input[type="date"],
input[type="datetime-local"],
input[type="time"] {
  color-scheme: light;
  /* MOBILE FIX: Prevent iOS zoom */
  font-size: 16px;
}

/* Dark mode for date/time inputs - only when .dark class is present */
.dark input[type="date"],
.dark input[type="datetime-local"],
.dark input[type="time"] {
  color-scheme: dark;
}

/* Style the calendar icon */
input[type="date"]::-webkit-calendar-picker-indicator,
input[type="datetime-local"]::-webkit-calendar-picker-indicator,
input[type="time"]::-webkit-calendar-picker-indicator {
  cursor: pointer;
  opacity: 0.6;
  transition: opacity 0.2s;
}

input[type="date"]::-webkit-calendar-picker-indicator:hover,
input[type="datetime-local"]::-webkit-calendar-picker-indicator:hover,
input[type="time"]::-webkit-calendar-picker-indicator:hover {
  opacity: 1;
}

.dark input[type="date"]::-webkit-calendar-picker-indicator,
.dark input[type="datetime-local"]::-webkit-calendar-picker-indicator,
.dark input[type="time"]::-webkit-calendar-picker-indicator {
  filter: invert(1);
}

/* MOBILE: Safe area insets for notched devices */
@supports (padding: max(0px)) {
  body {
    padding-left: max(0px, env(safe-area-inset-left));
    padding-right: max(0px, env(safe-area-inset-right));
  }
}

/* ============================================================================
   MOBILE DRAG & DROP STYLES
   ============================================================================ */

/* Dragging state - card being actively dragged */
[data-dragging="true"] {
  @apply opacity-50 scale-95 transition-transform;
}

/* Long-press pending indicator - subtle pulse during delay */
@keyframes longPressPulse {
  0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
  50% { transform: scale(1.01); box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2); }
}

.long-press-pending {
  animation: longPressPulse 0.8s ease-in-out infinite;
}

/* Active drag state - lifted appearance */
.long-press-active {
  @apply scale-105 shadow-2xl ring-2 ring-blue-500/50;
  z-index: 50;
}

/* Prevent body scroll when dragging on mobile */
body.drag-active {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
  touch-action: none !important;
}

/* Mobile-specific drag overlay styling */
@media (max-width: 640px) {
  /* Larger touch targets on mobile for drag handles */
  [data-sortable] {
    touch-action: manipulation;
  }

  /* Prevent accidental text selection during drag */
  [data-sortable] * {
    -webkit-user-select: none;
    user-select: none;
  }
}
