/* Import Inter font - must be at top before @tailwind directives */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================================================
   LIGHT MODE DESIGN TOKENS - Production-Ready Design System
   ============================================================================ */
:root {
  /* Base Surfaces - Warm off-white tones for visual depth */
  --bg-app: #F5F7FB;
  --bg-app-gradient: linear-gradient(135deg, #E3F0FF 0%, #D4E8FD 35%, #E8D8F8 70%, #F0E0FA 100%);
  --bg-surface: #FFFFFF;
  --bg-card: #FFFFFF;
  --bg-card-hover: #F8FAFC;
  --bg-column: #F8FAFC;
  --bg-elevated: #FFFFFF;
  --bg-input: #F8FAFC;
  --bg-sidebar: #F8FAFC;
  --bg-section: #F1F5F9;
  --bg-header: #E2E8F0;

  /* Border colors - Visible but not harsh */
  --border-subtle: #CBD5E1;
  --border-default: #94A3B8;
  --border-strong: #64748B;

  /* Text colors - WCAG AAA compliant (>= 7:1 contrast) */
  --text-primary: #0B1220;
  --text-secondary: #475569;
  --text-muted: #64748B;
  --text-placeholder: #94A3B8;

  /* Icon colors - Good visibility */
  --icon-default: #64748B;
  --icon-hover: #0B1220;
  --icon-muted: #94A3B8;

  /* Card Shadows - Soft elevation for depth */
  --shadow-card: 0 6px 18px rgba(11, 18, 32, 0.06);
  --shadow-card-hover: 0 8px 24px rgba(11, 18, 32, 0.10);
  --shadow-elevated: 0 12px 32px rgba(11, 18, 32, 0.12);
  --shadow-dropdown: 0 16px 48px rgba(11, 18, 32, 0.14);

  /* Priority Badge Colors - WCAG compliant, distinct but not garish */
  --priority-low-bg: #E6F6EF;
  --priority-low-text: #0F9B6B;
  --priority-medium-bg: #FFF7ED;
  --priority-medium-text: #8A5A00;
  --priority-high-bg: #FFF0F1;
  --priority-high-text: #B42318;
  --priority-urgent-bg: #FFE8E9;
  --priority-urgent-text: #9F1E2A;
  --priority-none-bg: #F1F5F9;
  --priority-none-text: #475569;

  /* Status colors - Consistent with priority palette */
  --status-todo-bg: #F1F5F9;
  --status-todo-text: #475569;
  --status-progress-bg: #E0F2FE;
  --status-progress-text: #0369A1;
  --status-done-bg: #E6F6EF;
  --status-done-text: #0F9B6B;

  /* Brand Accent Colors - Unique identity */
  --accent-primary: #1397D3;
  --accent-primary-hover: #0E7AB3;
  --accent-secondary: #06B6D4;
  --accent-unique: #8E63FF;
  --accent-success: #0F9B6B;
  --accent-warning: #8A5A00;
  --accent-danger: #B42318;

  /* Button Gradient - Premium feel */
  --btn-primary-gradient: linear-gradient(135deg, #1397D3 0%, #06B6D4 100%);
  --btn-primary-gradient-hover: linear-gradient(135deg, #0E7AB3 0%, #0891B2 100%);
}

/* Dark mode overrides - Maintains brand identity */
.dark {
  /* Base Surfaces */
  --bg-app: #0F172A;
  --bg-app-gradient: linear-gradient(135deg, #0F172A 0%, #0D1A2D 35%, #151530 70%, #1A1535 100%);
  --bg-surface: #1E293B;
  --bg-card: #1E293B;
  --bg-card-hover: #334155;
  --bg-column: #1E293B;
  --bg-elevated: #1E293B;
  --bg-input: #334155;
  --bg-sidebar: #1E293B;
  --bg-section: #1E293B;
  --bg-header: #0F172A;

  /* Border colors */
  --border-subtle: #334155;
  --border-default: #475569;
  --border-strong: #64748B;

  /* Text colors */
  --text-primary: #F8FAFC;
  --text-secondary: #CBD5E1;
  --text-muted: #94A3B8;
  --text-placeholder: #64748B;

  /* Icon colors */
  --icon-default: #94A3B8;
  --icon-hover: #F8FAFC;
  --icon-muted: #64748B;

  /* Shadows - Deeper for dark mode */
  --shadow-card: 0 6px 18px rgba(0, 0, 0, 0.25);
  --shadow-card-hover: 0 8px 24px rgba(0, 0, 0, 0.35);
  --shadow-elevated: 0 12px 32px rgba(0, 0, 0, 0.4);
  --shadow-dropdown: 0 16px 48px rgba(0, 0, 0, 0.5);

  /* Priority Badge Colors - Adapted for dark mode */
  --priority-low-bg: rgba(15, 155, 107, 0.2);
  --priority-low-text: #6EE7B7;
  --priority-medium-bg: rgba(138, 90, 0, 0.2);
  --priority-medium-text: #FCD34D;
  --priority-high-bg: rgba(180, 35, 24, 0.2);
  --priority-high-text: #FCA5A5;
  --priority-urgent-bg: rgba(159, 30, 42, 0.25);
  --priority-urgent-text: #FECACA;
  --priority-none-bg: #334155;
  --priority-none-text: #94A3B8;

  /* Status colors */
  --status-todo-bg: #334155;
  --status-todo-text: #CBD5E1;
  --status-progress-bg: rgba(19, 151, 211, 0.2);
  --status-progress-text: #7DD3FC;
  --status-done-bg: rgba(15, 155, 107, 0.2);
  --status-done-text: #6EE7B7;

  /* Accent colors - Same brand, adjusted for dark */
  --accent-primary: #38BDF8;
  --accent-primary-hover: #7DD3FC;
  --accent-secondary: #22D3EE;
  --accent-unique: #A78BFA;
  --accent-success: #6EE7B7;
  --accent-warning: #FCD34D;
  --accent-danger: #FCA5A5;

  /* Button Gradient */
  --btn-primary-gradient: linear-gradient(135deg, #38BDF8 0%, #22D3EE 100%);
  --btn-primary-gradient-hover: linear-gradient(135deg, #7DD3FC 0%, #67E8F9 100%);
}

/* Base Styles */
@layer base {
  html {
    @apply antialiased scroll-smooth;
    /* Prevent pull-to-refresh in horizontal direction */
    overscroll-behavior-x: none;
  }

  body {
    background: var(--bg-app-gradient);
    background-attachment: fixed;
    color: var(--text-primary);
    @apply font-sans transition-colors duration-200;
    min-height: 100vh;
  }

  /* Scrollbar visibility - show on mobile for feedback, hide on desktop until hover */
  * {
    scrollbar-width: thin;
    /* Show scrollbar on mobile */
    scrollbar-color: rgba(155, 155, 155, 0.3) transparent;
  }

  /* Desktop: hide scrollbar until hover */
  @media (min-width: 768px) {
    * {
      scrollbar-color: transparent transparent;
    }
  }

  *::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  *::-webkit-scrollbar-track {
    background: transparent;
  }

  *::-webkit-scrollbar-thumb {
    /* Visible on mobile by default for feedback */
    background: rgba(155, 155, 155, 0.3);
    border-radius: 3px;
  }

  /* Desktop: hide until hover */
  @media (min-width: 768px) {
    *::-webkit-scrollbar-thumb {
      background: transparent;
    }

    *:hover::-webkit-scrollbar-thumb {
      background: rgba(155, 155, 155, 0.3);
    }
  }

  *::-webkit-scrollbar-thumb:hover {
    background: rgba(155, 155, 155, 0.5);
  }
}

/* Component Styles */
@layer components {
  /* Card - with proper elevation */
  .card {
    background-color: var(--bg-card);
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-card);
    @apply rounded-xl transition-shadow duration-200;
  }

  .card:hover {
    box-shadow: var(--shadow-card-hover);
  }

  /* Task card - specific styling */
  .task-card {
    background-color: var(--bg-card);
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-card);
    @apply rounded-lg transition-all duration-200;
  }

  .task-card:hover {
    background-color: var(--bg-card-hover);
    box-shadow: var(--shadow-card-hover);
  }

  /* Elevated components (modals, dropdowns) */
  .elevated {
    background-color: var(--bg-elevated);
    box-shadow: var(--shadow-elevated);
  }

  .dropdown {
    background-color: var(--bg-elevated);
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-dropdown);
  }

  /* Buttons */
  .btn {
    @apply inline-flex items-center justify-center gap-2 font-medium rounded-lg;
    @apply transition-all duration-200;
    @apply focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500;
    @apply dark:focus:ring-offset-gray-900;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .btn-sm {
    @apply px-3 py-1.5 text-sm;
  }

  .btn-md {
    @apply px-4 py-2 text-sm;
  }

  .btn-lg {
    @apply px-5 py-2.5 text-base;
  }

  .btn-primary {
    background: var(--btn-primary-gradient);
    @apply text-white;
  }

  .btn-primary:hover {
    background: var(--btn-primary-gradient-hover);
  }

  .btn-secondary {
    background-color: var(--bg-section);
    color: var(--text-secondary);
    border: 1px solid var(--border-default);
  }

  .btn-secondary:hover {
    background-color: var(--bg-card-hover);
    color: var(--text-primary);
  }

  .btn-ghost {
    background-color: transparent;
    color: var(--text-secondary);
  }

  .btn-ghost:hover {
    background-color: var(--bg-section);
    color: var(--text-primary);
  }

  .btn-danger {
    background-color: var(--accent-danger);
    @apply text-white;
  }

  .btn-danger:hover {
    opacity: 0.9;
  }

  /* Input - MOBILE FIX: 16px font prevents iOS zoom */
  .input {
    @apply w-full px-3 py-2 text-base rounded-lg;
    background-color: var(--bg-input);
    color: var(--text-primary);
    border: 1px solid var(--border-default);
  }

  .input:focus {
    @apply outline-none ring-2 ring-offset-0;
    border-color: var(--accent-primary);
    --tw-ring-color: var(--accent-primary);
  }

  .input::placeholder {
    color: var(--text-placeholder);
  }

  /* Badge */
  .badge {
    @apply inline-flex items-center px-2 py-0.5 rounded text-xs font-medium;
  }

  .badge-gray {
    background-color: var(--priority-none-bg);
    color: var(--priority-none-text);
  }

  .badge-primary {
    background-color: var(--status-progress-bg);
    color: var(--status-progress-text);
  }

  .badge-success {
    background-color: var(--priority-low-bg);
    color: var(--priority-low-text);
  }

  .badge-warning {
    background-color: var(--priority-medium-bg);
    color: var(--priority-medium-text);
  }

  .badge-error {
    background-color: var(--priority-high-bg);
    color: var(--priority-high-text);
  }

  /* Priority badges - muted, calming colors */
  .badge-priority-none {
    background-color: var(--priority-none-bg);
    color: var(--priority-none-text);
  }

  .badge-priority-low {
    background-color: var(--priority-low-bg);
    color: var(--priority-low-text);
  }

  .badge-priority-medium {
    background-color: var(--priority-medium-bg);
    color: var(--priority-medium-text);
  }

  .badge-priority-high {
    background-color: var(--priority-high-bg);
    color: var(--priority-high-text);
  }

  .badge-priority-urgent {
    background-color: var(--priority-urgent-bg);
    color: var(--priority-urgent-text);
  }

  /* Status badges */
  .badge-status-todo {
    background-color: var(--status-todo-bg);
    color: var(--status-todo-text);
  }

  .badge-status-progress {
    background-color: var(--status-progress-bg);
    color: var(--status-progress-text);
  }

  .badge-status-done {
    background-color: var(--status-done-bg);
    color: var(--status-done-text);
  }

  /* Stat card */
  .stat-card {
    @apply card p-5;
  }

  .stat-value {
    color: var(--text-primary);
    @apply text-2xl font-bold;
  }

  .stat-label {
    color: var(--text-muted);
    @apply text-sm;
  }

  /* Page header */
  .page-header {
    @apply mb-6;
  }

  .page-title {
    color: var(--text-primary);
    @apply text-2xl font-bold;
  }

  .page-description {
    color: var(--text-secondary);
    @apply mt-1;
  }

  .section-title {
    color: var(--text-primary);
    @apply text-base font-semibold;
  }

  /* Text utility classes */
  .text-primary {
    color: var(--text-primary);
  }

  .text-secondary {
    color: var(--text-secondary);
  }

  .text-muted {
    color: var(--text-muted);
  }

  /* Icon utility classes */
  .icon-default {
    color: var(--icon-default);
  }

  .icon-default:hover {
    color: var(--icon-hover);
  }

  .icon-muted {
    color: var(--icon-muted);
  }

  /* Empty state */
  .empty-state {
    @apply flex flex-col items-center justify-center py-12 px-4 text-center;
  }

  .empty-state-icon {
    color: var(--icon-muted);
    @apply w-12 h-12 mb-3;
  }

  .empty-state-title {
    color: var(--text-primary);
    @apply text-sm font-medium mb-1;
  }

  .empty-state-description {
    color: var(--text-muted);
    @apply text-sm;
  }

  /* List item */
  .list-item {
    @apply flex items-center gap-3 px-4 py-3;
    @apply transition-colors cursor-pointer;
  }

  .list-item:hover {
    background-color: var(--bg-card-hover);
  }

  /* Spinner */
  .spinner {
    @apply animate-spin rounded-full border-2;
    @apply border-gray-200 border-t-blue-600;
    @apply dark:border-gray-700 dark:border-t-blue-400;
  }

  .spinner-sm {
    @apply w-4 h-4;
  }

  .spinner-md {
    @apply w-5 h-5;
  }

  .spinner-lg {
    @apply w-8 h-8;
  }

  /* Glass nav - frosted glass effect that complements the gradient */
  .glass {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.85) 0%, rgba(248, 250, 252, 0.9) 100%);
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
    border-bottom: 1px solid rgba(203, 213, 225, 0.5);
    box-shadow: 0 4px 16px rgba(11, 18, 32, 0.04);
  }

  .dark .glass {
    background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(30, 41, 59, 0.85) 100%);
    border-bottom: 1px solid rgba(51, 65, 85, 0.5);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  }
}

/* Utilities */
@layer utilities {
  .press-scale {
    @apply active:scale-[0.98] transition-transform;
  }

  .hover-lift {
    @apply hover:-translate-y-0.5 hover:shadow-md transition-all;
  }

  /* MOBILE TOUCH UTILITIES */
  /* Minimum 40x40px touch target for mobile usability */
  .touch-target {
    @apply min-w-[40px] min-h-[40px] flex items-center justify-center;
  }

  /* Prevent text selection on touch drag */
  .touch-none {
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
  }

  /* Smooth momentum scrolling for mobile */
  .touch-scroll {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  /* Prevent tap highlight on mobile */
  .tap-highlight-none {
    -webkit-tap-highlight-color: transparent;
  }
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

.animate-fade-in {
  animation: fadeIn 0.2s ease-out;
}

.animate-slide-up {
  animation: slideUp 0.2s ease-out;
}

.animate-scale-in {
  animation: scaleIn 0.15s ease-out;
}

/* Slide down animation for notifications */
@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slide-down {
  animation: slideDown 0.3s ease-out forwards;
}

/* Toast enter/leave animations */
.animate-enter {
  animation: slideDown 0.3s ease-out forwards;
}

.animate-leave {
  animation: slideDown 0.3s ease-in reverse forwards;
}

/* MOBILE: Reduce motion for accessibility */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Date/time input styling - light mode by default */
input[type="date"],
input[type="datetime-local"],
input[type="time"] {
  color-scheme: light;
  /* MOBILE FIX: Prevent iOS zoom */
  font-size: 16px;
}

/* Dark mode for date/time inputs - only when .dark class is present */
.dark input[type="date"],
.dark input[type="datetime-local"],
.dark input[type="time"] {
  color-scheme: dark;
}

/* Style the calendar icon */
input[type="date"]::-webkit-calendar-picker-indicator,
input[type="datetime-local"]::-webkit-calendar-picker-indicator,
input[type="time"]::-webkit-calendar-picker-indicator {
  cursor: pointer;
  opacity: 0.6;
  transition: opacity 0.2s;
}

input[type="date"]::-webkit-calendar-picker-indicator:hover,
input[type="datetime-local"]::-webkit-calendar-picker-indicator:hover,
input[type="time"]::-webkit-calendar-picker-indicator:hover {
  opacity: 1;
}

.dark input[type="date"]::-webkit-calendar-picker-indicator,
.dark input[type="datetime-local"]::-webkit-calendar-picker-indicator,
.dark input[type="time"]::-webkit-calendar-picker-indicator {
  filter: invert(1);
}

/* MOBILE: Safe area insets for notched devices */
@supports (padding: max(0px)) {
  body {
    padding-left: max(0px, env(safe-area-inset-left));
    padding-right: max(0px, env(safe-area-inset-right));
  }
}

/* ============================================================================
   MOBILE DRAG & DROP STYLES
   ============================================================================ */

/* Dragging state - card being actively dragged */
[data-dragging="true"] {
  @apply opacity-50 scale-95 transition-transform;
}

/* Long-press pending indicator - subtle pulse during delay */
@keyframes longPressPulse {
  0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
  50% { transform: scale(1.01); box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2); }
}

.long-press-pending {
  animation: longPressPulse 0.8s ease-in-out infinite;
}

/* Active drag state - lifted appearance */
.long-press-active {
  @apply scale-105 shadow-2xl ring-2 ring-blue-500/50;
  z-index: 50;
}

/* Prevent body scroll when dragging on mobile */
body.drag-active {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
  touch-action: none !important;
}

/* Mobile-specific drag overlay styling */
@media (max-width: 640px) {
  /* Larger touch targets on mobile for drag handles */
  [data-sortable] {
    touch-action: manipulation;
  }

  /* Prevent accidental text selection during drag */
  [data-sortable] * {
    -webkit-user-select: none;
    user-select: none;
  }
}
